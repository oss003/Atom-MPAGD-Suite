
DEFINEWINDOW    1 0 7 32

DEFINECONTROLS  'Q' 'Z' 'N' 'M' 32 'A' 'H' '1' '2' '3' '4'

DEFINEBLOCK     EMPTYBLOCK
                0 0 0 0 0 0 0 0 96

DEFINEBLOCK     WALLBLOCK
                170 138 168 170 42 170 162 170 96

DEFINEBLOCK     EMPTYBLOCK
                101 17 0 0 0 0 0 0 96

DEFINEBLOCK     EMPTYBLOCK
                0 0 0 0 0 0 0 68 96

DEFINEBLOCK     EMPTYBLOCK
                144 64 144 64 144 64 144 64 96

DEFINEBLOCK     EMPTYBLOCK
                6 1 6 1 6 1 6 1 96

DEFINEBLOCK     EMPTYBLOCK
                144 64 144 64 144 144 164 41 96

DEFINEBLOCK     EMPTYBLOCK
                6 1 6 1 6 6 26 104 96

DEFINEBLOCK     EMPTYBLOCK
                41 165 164 144 144 64 144 64 96

DEFINEBLOCK     EMPTYBLOCK
                104 90 26 6 6 1 6 1 96

DEFINEBLOCK     DEADLYBLOCK
                223 255 247 255 223 255 247 255 96

DEFINEBLOCK     EMPTYBLOCK
                101 17 1 0 1 0 1 0 96

DEFINEBLOCK     EMPTYBLOCK
                192 48 12 3 12 48 192 48 96

DEFINEBLOCK     CUSTOMBLOCK
                85 101 85 85 89 85 101 85 96


DEFINESPRITE    4
                85 64 4 60 12 212 12 252 40 60 40 160 40 152 40 152
                10 148 0 168 0 40 0 48 0 48 0 240 0 192 0 192
                21 0 4 60 12 212 12 252 40 60 40 160 40 152 40 152
                10 148 0 168 0 40 0 48 0 48 0 240 0 192 0 192
                4 0 4 60 12 212 12 252 40 60 40 160 40 152 40 152
                10 148 0 168 0 40 0 48 0 48 0 240 0 192 0 192
                21 0 4 60 12 212 12 252 40 60 40 160 40 152 40 152
                10 148 0 168 0 40 0 48 0 48 0 240 0 192 0 192

DEFINESPRITE    4
                1 85 60 16 23 48 63 48 60 40 10 40 38 40 38 40
                22 160 42 0 40 0 12 0 12 0 15 0 3 0 3 0
                0 84 60 16 23 48 63 48 60 40 10 40 38 40 38 40
                22 160 42 0 40 0 12 0 12 0 15 0 3 0 3 0
                0 16 60 16 23 48 63 48 60 40 10 40 38 40 38 40
                22 160 42 0 40 0 12 0 12 0 15 0 3 0 3 0
                0 84 60 16 23 48 63 48 60 40 10 40 38 40 38 40
                22 160 42 0 40 0 12 0 12 0 15 0 3 0 3 0

DEFINESPRITE    4
                84 0 16 240 51 80 51 240 160 240 162 128 162 96 162 96
                42 80 2 160 0 160 0 240 0 240 0 192 0 192 0 240
                84 0 16 240 51 80 51 240 160 240 162 128 162 96 162 96
                42 80 2 160 0 160 0 252 0 207 3 0 3 0 3 192
                84 0 16 240 51 80 51 240 160 240 162 128 162 96 162 96
                42 80 2 160 0 160 0 240 3 252 15 12 12 15 12 0
                84 0 16 240 51 80 51 240 160 240 162 128 162 96 162 96
                42 80 2 160 0 160 0 240 3 240 3 48 0 48 0 60

DEFINESPRITE    4
                0 21 15 4 5 204 15 204 15 10 2 138 9 138 9 138
                5 168 10 128 10 0 15 0 15 0 3 0 3 0 15 0
                0 21 15 4 5 204 15 204 15 10 2 138 9 138 9 138
                5 168 10 128 10 0 63 0 243 0 0 192 0 192 3 192
                0 21 15 4 5 204 15 204 15 10 2 138 9 138 9 138
                5 168 10 128 10 0 15 0 63 192 48 240 240 48 0 48
                0 21 15 4 5 204 15 204 15 10 2 138 9 138 9 138
                5 168 10 128 10 0 15 0 15 192 12 192 12 0 60 0

DEFINESPRITE    2
                0 0 0 0 0 0 0 0 10 128 10 192 9 80 9 64
                1 0 15 192 13 192 13 192 13 195 13 195 13 127 0 0
                0 0 0 0 0 0 0 0 10 128 10 192 9 80 9 64
                1 0 15 196 13 84 15 192 15 195 15 195 15 255 0 0

DEFINESPRITE    2
                0 0 0 0 0 0 0 0 2 160 3 160 5 96 1 96
                0 64 3 240 3 112 3 112 3 112 195 112 253 112 0 0
                0 0 0 0 0 0 0 0 2 160 3 160 5 96 1 96
                0 64 19 240 21 112 3 240 195 240 195 240 255 240 0 0

DEFINESPRITE    2
                0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 32
                0 128 2 96 0 64 3 240 3 240 3 240 3 240 3 240
                0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 128
                2 32 0 128 0 64 3 240 3 240 3 240 3 240 3 240

DEFINESPRITE    4
                1 0 0 0 1 0 0 0 1 0 0 0 1 0 0 0
                1 0 0 0 33 32 143 200 183 120 191 248 136 136 136 136
                1 0 0 0 1 0 0 0 1 0 0 0 1 0 0 0
                33 32 143 200 183 120 191 248 136 136 136 136 0 0 0 0
                1 0 0 0 1 0 0 0 33 32 143 200 183 120 191 248
                136 136 136 136 0 0 0 0 0 0 0 0 0 0 0 0
                1 0 0 0 1 0 0 0 1 0 0 0 1 0 0 0
                33 32 143 200 183 120 191 248 136 136 136 136 0 0 0 0


DEFINEOBJECT    96 255 8 8
                0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
                0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0



DEFINESCREEN      0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
                  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
                  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
                  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
                  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
                  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
                  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0
SPRITEPOSITION  0 1 40 128

DEFINESCREEN      1   1   1   1   1   0   0   0   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
                  1   1   1   1   1   0   0   0   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
                  1   1   1   1   1   0   0   0   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
                  1   1   1   8   2   0   0   0   2   2   2   2   2  13  13   2   2   2   2   2   2   2   2   2   2   2   2   2   9   1   1   1
                  1   1   1   4   0   0   0   0   0   0   0   0   0  13  13   0   0   0   0   0   0   0   0   0   0   0   0   0   5   1   1   1
                  1   1   1   6   3   3   3   3   3   3   3   3   3  13  13   3   0   0   0   3   3   3   3   3   3   3   3   3   7   1   1   1
                  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   4   0   5   1   1   1   1   1   1   1   1   1   1   1   1   1
SPRITEPOSITION  0 1 8 40

DEFINESCREEN      1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   4   0   5   1   1   1   1   1   1   1   1   1   1   1   1   1
                  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   4   0   5   1   1   1   1   1   1   1   1   1   1   1   1   1
                  1   1   1   8   2   2   2   2   2   2   2  11   2   2   2   2   0   0   0   2   2   2   2   2   2   2   2   2   9   1   1   1
                  1   1   1   4   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   5   1   1   1
                  1   1   1   4   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   5   1   1   1
                  1   1   1   6   3   3   3   3   3   3   3   3   3   3   3   3   3   3   3   3   3   3   3   3   3   3   3   3   7   1   1   1
                  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
SPRITEPOSITION  0 0 8 40
SPRITEPOSITION  1 4 40 24
SPRITEPOSITION  2 7 32 88

MAP             WIDTH 1
                STARTSCREEN 0
                 0 
                 1
                 2
ENDMAP

DEFINEFONT      0 0 0 0 0 0 0 0
                12 12 12 12 0 0 12 0
                204 204 0 0 0 0 0 0
                0 204 252 204 204 252 204 0
                48 48 60 192 48 12 240 48
                204 204 12 48 48 192 204 204
                48 204 204 48 207 204 51 0
                48 192 0 0 0 0 0 0
                12 48 48 48 48 48 12 0
                48 12 12 12 12 12 48 0
                0 204 48 252 48 204 0 0
                0 48 48 252 48 48 0 0
                0 0 0 0 0 48 48 192
                0 0 0 252 0 0 0 0
                0 0 0 0 0 0 48 0
                12 12 12 48 48 192 192 192
                48 204 204 204 204 204 48 0
                48 240 48 48 48 48 48 0
                48 204 12 12 48 192 252 0
                48 204 12 48 12 204 48 0
                12 60 204 204 204 252 12 0
                252 192 192 240 12 204 48 0
                12 48 192 240 204 204 48 0
                252 12 12 48 192 192 192 0
                48 204 204 48 204 204 48 0
                48 204 204 60 12 48 192 0
                0 48 48 0 48 48 0 0
                0 48 48 0 48 48 192 0
                0 12 48 192 48 12 0 0
                0 0 252 0 0 252 0 0
                0 192 48 12 48 192 0 0
                48 204 12 48 48 0 48 0
                0 0 60 204 204 192 60 0
                48 204 204 252 204 204 204 0
                240 204 204 240 204 204 240 0
                48 204 192 192 192 204 48 0
                240 204 204 204 204 204 240 0
                252 192 192 252 192 192 252 0
                252 192 192 240 192 192 192 0
                48 204 192 192 204 204 60 0
                204 204 204 252 204 204 204 0
                48 48 48 48 48 48 48 0
                12 12 12 12 12 204 48 0
                204 204 204 240 204 204 204 0
                192 192 192 192 192 192 252 0
                204 204 252 204 204 204 204 0
                240 204 204 204 204 204 204 0
                48 204 204 204 204 204 48 0
                240 204 204 240 192 192 192 0
                48 204 204 204 252 204 60 0
                240 204 204 240 204 204 204 0
                48 204 192 48 12 204 48 0
                252 48 48 48 48 48 48 0
                204 204 204 204 204 204 60 0
                204 204 204 204 204 204 48 0
                204 204 204 204 252 204 204 0
                204 204 204 48 204 204 204 0
                204 204 204 252 48 48 48 0
                252 12 12 48 192 192 252 0
                240 192 192 192 192 192 240 0
                192 192 192 48 48 12 12 12
                60 12 12 12 12 12 60 0
                48 204 0 0 0 0 0 0
                0 0 0 0 0 0 0 252
                48 192 0 0 0 0 0 0
                0 0 60 204 204 204 60 0
                192 192 240 204 204 204 240 0
                0 0 60 192 192 192 60 0
                12 12 60 204 204 204 60 0
                0 0 48 204 252 192 60 0
                60 48 252 48 48 48 48 0
                0 0 60 204 204 60 204 48
                192 192 252 204 204 204 204 0
                48 0 240 48 48 48 252 0
                48 0 240 48 48 48 48 192
                192 192 204 240 240 204 204 0
                240 48 48 48 48 48 252 0
                0 0 204 252 204 204 204 0
                0 0 252 204 204 204 204 0
                0 0 48 204 204 204 48 0
                0 0 240 204 204 204 240 192
                0 0 60 204 204 204 60 12
                0 0 252 204 192 192 192 0
                0 0 60 192 48 12 240 0
                48 48 252 48 48 48 60 0
                0 0 204 204 204 204 252 0
                0 0 204 204 204 204 48 0
                0 0 204 204 204 252 204 0
                0 0 204 204 48 204 204 0
                0 0 204 204 252 48 48 0
                0 0 252 12 48 192 252 0
                12 48 48 192 48 48 12 0
                12 12 12 12 12 12 12 12
                192 48 48 12 48 48 192 0
                0 240 0 0 0 0 0 0
                255 255 255 255 255 255 255 0

EVENT PLAYER
at 0,0:display y
IF SCREEN > 0
	; Reset 'is flying' setting
	LET SETTINGA = 0
	; Reset 'is running l/r' setting
	LET SETTINGB = 0
	IF KEY UP
			USER 5
;			ANIMATE
			LET SETTINGA = 1
		IF CANGOUP
			IF Y => TOPEDGE
				SPRITEUP
				ANIMATE
			ENDIF
		ENDIF
	ELSE
		IF CANGODOWN
			LET SETTINGA = 1
			USER 5
			SPRITEDOWN
			ANIMATE
		ENDIF
		IF Y > 47
at 0,4:print"DOWN"
			ADD 1 TO SCREEN
			LET Y = TOPEDGE
			EXIT
			;SCREENDOWN
		ENDIF
	ENDIF

	IF KEY LEFT
		LET DIRECTION = LEFT
		SUBTRACT 4 FROM X
		IF CUSTOM
			ADD 4 TO X
		ELSE
			ADD 4 TO X
			IF X <= LEFTEDGE
				SCREENLEFT
				LET X = RIGHTEDGE
				EXIT
			ELSE
				IF CANGOLEFT
					LET SETTINGB = 1
					SPRITELEFT
					ANIMATE
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	IF KEY RIGHT
		LET DIRECTION = RIGHT
		ADD 1 TO X
		IF CUSTOM
			SUBTRACT 1 FROM X
		ELSE
			SUBTRACT 1 FROM X
			IF X >= RIGHTEDGE
				SCREENRIGHT
				LET X = LEFTEDGE
				EXIT
			ELSE
				IF CANGORIGHT
					LET SETTINGB = 1
					SPRITERIGHT
					ANIMATE
				ENDIF
			ENDIF
		ENDIF
	ENDIF

	; Sprite animation
	IF DIRECTION = LEFT
		IF SETTINGA = 0
			LET IMAGE = 3
		ELSE
			LET IMAGE = 1
		ENDIF
	ELSE
		IF SETTINGA = 0
			LET IMAGE = 2
		ELSE
			LET IMAGE = 0
		ENDIF
	ENDIF

	; Stand still
	IF SETTINGB = 0
	  IF SETTINGA = 0
		LET FRAME = 0
	  ENDIF
	ENDIF

	; Shoot laser
	IF KEY FIRE
		IF G = 0
			LASER DIRECTION
			LET G = 1
		ENDIF
	ELSE
		LET F = 0
	ENDIF
	
	; Drop dynamite
	IF KEY FIRE2
		IF D = 0
			SPAWN 3 6
			IF DIRECTION = RIGHT
				SPAWNED
					ADD 2 TO X
				ENDSPRITE
				ELSE
				SPAWNED
					SUBTRACT 2 FROM X
				ENDSPRITE
			ENDIF
			LET D = 50
		ENDIF
	ENDIF
	
	IF DEADLY
		KILL
	ENDIF

	IF SETTINGA > 0
		ANIMATE VERYSLOW
	ENDIF

	GETBLOCKS
ELSE
	IF F = 1
		IF Q > 0
			SUBTRACT 1 FROM Q
		ELSE
			; Draw Titlescreen
;			CLS
			USER 0
			PAPER 0
			INK 3
			AT 7,0
			TICKER 32 "  To start press Fire! Keys: Left/Right: N/M. Q to fly up. A to drop bomb. Space to shoot. Or Joystick: Fire to shoot. Arm to drop bomb. Visit BlueBilby.com ...    "
			PAPER 0
			INK 1
			AT 7,13
			PRINT "Last score:"
			AT 7,25
			SHOWSCORE
			AT 7,31
			PRINT "0"
			LET F = 2	
		ENDIF
	ENDIF
	IF F = 2
		ANIMATE
		IF KEY FIRE
			LET F = 3
			TICKER 0
			LET LIVES = 3
			LET L = 0	; Last level extra life given
			USER 4
			LET Q = 170
			USER 5
			CLS
			; Reset colour palette for game blocks
			INK 3
			NEXTLEVEL
		ENDIF
	ENDIF
ENDIF


EVENT SPRITETYPE1



EVENT SPRITETYPE2
; Event for spiders, snakes, bats, moths.
ANIMATE SLOW

EVENT SPRITETYPE3

IF D > 0
	ANIMATE
	SUBTRACT 1 FROM D
	IF D = 1
		IF CUSTOM
			CRASH 10
			; Delete wall depending on screen number
			IF SCREEN = 1
				REMOVE
				LET LINE = 4
				LET COLUMN = 13
				PUTBLOCK 0
				PUTBLOCK 0
				LET LINE = 5
				LET COLUMN = 13
				PUTBLOCK 0
				PUTBLOCK 0
				LET LINE = 6
				LET COLUMN = 13
				PUTBLOCK 0
				PUTBLOCK 0
				LET D = 0
				EXPLODE 50
			ENDIF
			LET D = 0
		ELSE
			;EXPLODE 10
			;CRASH
			LET D = 0
			REMOVE
		ENDIF
	ENDIF
ENDIF

EVENT SPRITETYPE4
EVENT SPRITETYPE5
EVENT SPRITETYPE6
EVENT SPRITETYPE7
EVENT SPRITETYPE8
EVENT INITSPRITE

IF TYPE PLAYER
  LET DIRECTION = RIGHT

ENDIF



EVENT MAINLOOP1

IF SCREEN > 0
  ; In-game
  INK 1
  AT 0,3
  PRINT "S"
  AT 0,5
  SHOWSCORE
  AT 0,11
  PRINT "0"
  AT 0,25
  PRINT "L"
  AT 0,27
  DISPLAY LIVES
  IF T < 21
    INK 3
  ENDIF
  AT 0,14
  PRINT "T"
  AT 0,16
  DISPLAY SECONDS T
  AT 0,17
  PRINT ":"
  INK 3
  PAPER 0
  ; Time to complete level
  IF S > 0
      SUBTRACT 1 FROM S
  ELSE
    LET S = 30
    IF T > 0
      SUBTRACT 1 FROM T
    ENDIF
  ENDIF
ENDIF

EVENT MAINLOOP2

EVENT INTROMENU

CLS
PAPER 0
INK 1
AT 0 0
PRINT "Helicopter Emergency Rescue Ops"
INK 2
AT 1 0
PRINT "You are tasked with rescuing"
AT 2 0
PRINT "lost miners from lava-filled,"
AT 3 0
PRINT "dark and dangerous caverns!"
AT 4 0
PRINT "Can you save everyone, hero?"
INK 1
AT 5 0
PRINT "Pick :"
INK 3
AT 5 10
PRINT "1. KEYS: N M Q A SPACE"
AT 6 10
PRINT "2. JOYSTICK 1"
AT 7 10
PRINT "3. JOYSTICK 2"


LET F = 0
WHILE F=0
	IF KEY OPTION1
	  LET CONTROL = 0
	  LET F = 1
	ENDIF
	IF KEY OPTION2
	  LET CONTROL = 1
	  LET F = 1
	ENDIF
	IF KEY OPTION3
	  LET CONTROL = 2
	  LET F = 1
	  LET Q = 20
	ENDIF
ENDWHILE

EVENT GAMEINIT



EVENT RESTARTSCREEN
EVENT FELLTOOFAR
EVENT KILLPLAYER

  SUBTRACT 1 FROM LIVES
  AT 0,27
  DISPLAY LIVES
  ;LET W = 0 ; Reset Weapon status
  ;LET P = 0 ; Reset Pot status
  ;LET M = 0 ; Reset Plant weapon

  LET B = 5
  WHILE B < 60
    USER 1
    ADD 4 TO B
  ENDWHILE
EVENT LOSTGAME
EVENT COMPLETEDGAME
EVENT NEWHIGHSCORE
EVENT COLLECTBLOCK
